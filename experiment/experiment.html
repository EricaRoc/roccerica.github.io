<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="jspsych-6.2.0/jspsych.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-image-keyboard-response.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-video-keyboard-response.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-image-button-response.js"></script>
    <script src="jspsych-6.2.0/plugins/jspsych-video-button-response.js"></script>
    <link href="jspsych-6.2.0/css/jspsych.css" rel="stylesheet" type="text/css">
  </head>
  <body></body>
  <script>

    /* create timeline */
    var timeline = [];

    /* define welcome message trial */
    var welcome = {
      type: "html-keyboard-response",
      stimulus: "Benvenuto all'esperimento! Premi un qualsiasi tasto per iniziare."
    };
    timeline.push(welcome);

    /* define instructions trial */
    var instructions = {
      type: "html-keyboard-response",
      stimulus: "<p> In questo esperimento ti verranno mostrati diversi video di " +
          "10 secondi ognuno.</p><p> Nei video sono presenti due nuvole di punti, " +
          "anche dette Point Cloud. </p> I Point Cloud sono rappresentazioni 3D " +
          "di diversi oggetti.</p><p> Nel video saranno presenti due Point Cloud: " +
          "l'originale e una sua versione con delle distorsioni.</p>" +
          "<p> Il tuo compito è di dare un voto di quanto riesci a vedere la distorsione " +
          "su una scala che va da 1 a 5: </p>" +
          "<p> 1 : <strong> impercettibile </strong> </p>" +
          "<p> 2 : <strong> lo vedo se guardo attentamente </strong> </p>" +
          "<p> 3 : <strong> vedo qualcosa ma non sono sicuro </strong> </p>" +
          "<p> 4 : <strong> vedo una distorsione </strong> </p>" +
          "<p> 5 : <strong>  si nota </strong> </p>" +
          "<p>Si inizierà con una sessione di prova, per poi a seguire " +
          "l'esperimento. </p> <p> Premi un qualsiasi tasto per iniziare </p>",
      post_trial_gap: 2000
    };
    timeline.push(instructions);

    /*test trials*/
    var test_stimuli = [
      { stimulus: 'vid/prova.mp4'},
      { stimulus: 'vid/sample_video.mp4'}
    ];

    var fixation = {
      type: 'html-keyboard-response',
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: jsPsych.NO_KEYS,
      trial_duration: function(){
      return jsPsych.randomization.sampleWithoutReplacement([250, 500, 750, 1000, 1250, 1500, 1750, 2000], 1)[0];
    },
    data: {test_part: 'fixation'}
  }

    var test = {
      type: 'video-button-response',
      stimulus: jsPsych.timelineVariable('stimulus'),
      choices: ['1','2','3','4','5']
    }

    var test_procedure = {
      timeline: [fixation, test],
      timeline_variables: test_stimuli,
      randomize_order : true,
      repetitions: 5
    }



    timeline.push(test_procedure);
    var video = ['vid/sample_video.mp4', 'vid/prova.mp4'];

    /* start the experiment */
    jsPsych.init({
      timeline: timeline,
      preload_video: video,
      on_finish: function() {
        jsPsych.data.displayData();
      }

    });
  </script>
  </html>
